#!/usr/bin/env sh

better_ls() {
    # POSIX-safe "local" implementation
    # (ignored in shells that don't support it)
    local_is_supported=false
    ( local x=1 ) 2>/dev/null && local_is_supported=true

    if $local_is_supported; then
        local LS TS files hidden_files current_pwd
    fi

    # Find ls binary
    LS=$(command -v ls)

    # Timestamp format
    TS="+%d-%m-%Y %R"

    #
    # CASE 1 — No arguments → enhanced ls in current dir
    #
    if [ "$#" -eq 0 ]; then

        # Count visible + hidden files (except . and ..)
        files=$($LS -Ua 2>/dev/null | wc -l)

        if [ "$files" -ne 0 ]; then
            # List . and .. and everything else
            # (brace expansion replaced with explicit items)
            $LS -d . .. * \
                -lA --color=auto --human-readable \
                --time-style="$TS" --group-directories-first \
                2>/dev/null

            # Count hidden files (.[^.]*)
            hidden_files=$($LS -U -d .[^.]* 2>/dev/null | wc -l)

            if [ "$hidden_files" -ne 0 ]; then
                printf '\n'
                $LS -d .[^.]* \
                    -l --color=auto --hide='..' \
                    --human-readable --time-style="$TS" \
                    --group-directories-first
            fi

        else
            # Folder is empty → show only . and ..
            $LS -d . .. \
                -lA --color=auto --human-readable \
                --
